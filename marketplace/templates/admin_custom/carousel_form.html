{% extends 'admin_custom/base.html' %}

{% block title %}{{ action }} Imagem do Carrossel - Admin{% endblock %}

{% block content %}
<div class="admin-card">
    <h2>{{ action }} Imagem do Carrossel</h2>
    
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="alt_text">Texto Alternativo</label>
            <input 
                type="text" 
                name="alt_text" 
                id="alt_text"
                class="form-control" 
                value="{{ carousel_image.alt_text|default:'' }}"
                placeholder="Descrição da imagem para acessibilidade"
            />
            <small style="color: #7f8c8d; margin-top: 0.25rem; display: block;">
                Este texto será exibido quando a imagem não carregar e ajuda com acessibilidade
            </small>
        </div>
        
        <div class="form-group">
            <label for="image">Imagem {% if not carousel_image %}*{% endif %}</label>
            <input 
                type="file" 
                name="image" 
                id="image"
                class="form-control"
                accept="image/*"
                {% if not carousel_image %}required{% endif %}
                onchange="previewImage(event)"
            />
            {% if carousel_image.image %}
            <img src="{{ carousel_image.image.url }}" alt="{{ carousel_image.alt_text }}" class="image-preview" id="preview" style="max-width: 400px; max-height: 300px;">
            <p style="margin-top: 0.5rem; color: #7f8c8d; font-size: 0.875rem;">Deixe em branco para manter a imagem atual</p>
            {% else %}
            <img id="preview" class="image-preview" style="display: none; max-width: 400px; max-height: 300px;">
            {% endif %}
            <small style="color: #7f8c8d; margin-top: 0.5rem; display: block;">
                Recomendado: imagens com proporção 16:9 e resolução mínima de 1200x675 pixels
            </small>
        </div>
        
        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
            <button type="submit" class="btn btn-success">Salvar</button>
            <a href="{% url 'admin_carousel_list' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<script>
function previewImage(event) {
    const preview = document.getElementById('preview');
    const file = event.target.files[0];
    
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = 'block';
        }
        reader.readAsDataURL(file);
    }
}
</script>
{% endblock %}
