{% extends 'admin_base.html' %}
{% block title %}Dashboard - Admin{% endblock %}

{% block content %}
<h1 class="admin-page-title">üìä Dashboard</h1>

<!-- Estat√≠sticas -->
<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-value">{{ total_combos }}</div>
    <div class="stat-label">Combos</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-value">{{ total_products }}</div>
    <div class="stat-label">Produtos</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-value">{{ total_subproducts }}</div>
    <div class="stat-label">Ingredientes</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-value">{{ total_orders }}</div>
    <div class="stat-label">Pedidos</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-value">{{ total_users }}</div>
    <div class="stat-label">Usu√°rios</div>
  </div>
</div>

<!-- A√ß√µes R√°pidas -->
<div class="admin-card">
  <h2 class="admin-card-title">‚ö° A√ß√µes R√°pidas</h2>
  <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
    <a href="/admin/marketplace/combo/add/" class="btn btn-primary" target="_blank">
      ‚ûï Adicionar Combo
    </a>
    <a href="/admin/marketplace/product/add/" class="btn btn-success" target="_blank">
      ‚ûï Adicionar Produto
    </a>
    <a href="/admin/marketplace/subproduct/add/" class="btn btn-success" target="_blank">
      ‚ûï Adicionar Ingrediente
    </a>
    <a href="/admin/marketplace/carouselimage/add/" class="btn btn-secondary" target="_blank">
      ‚ûï Adicionar Imagem ao Carrossel
    </a>
  </div>
</div>

<!-- Pedidos Recentes -->
<div class="admin-card">
  <h2 class="admin-card-title">üì¶ Pedidos Recentes</h2>
  {% if recent_orders %}
  <table class="admin-table">
    <thead>
      <tr>
        <th>#ID</th>
        <th>Cliente</th>
        <th>Total</th>
        <th>Status</th>
        <th>Data</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody>
      {% for order in recent_orders %}
      <tr>
        <td><strong>#{{ order.id }}</strong></td>
        <td>{{ order.customer_name }}</td>
        <td>R$ {{ order.total }}</td>
        <td>
          {% if order.status == 'new' %}
          <span class="badge badge-new">Novo</span>
          {% elif order.status == 'preparing' %}
          <span class="badge badge-preparing">Preparando</span>
          {% elif order.status == 'done' %}
          <span class="badge badge-done">Conclu√≠do</span>
          {% elif order.status == 'cancelled' %}
          <span class="badge badge-cancelled">Cancelado</span>
          {% endif %}
        </td>
        <td>{{ order.created_at|date:"d/m/Y H:i" }}</td>
        <td>
          <a href="/admin/marketplace/order/{{ order.id }}/change/" class="btn btn-secondary" target="_blank" style="padding: 0.5rem 1rem; font-size: 0.85rem;">
            Ver Detalhes
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p style="color: #666; text-align: center; padding: 2rem;">Nenhum pedido encontrado.</p>
  {% endif %}
  
  <div style="margin-top: 1rem; text-align: center;">
    <a href="{% url 'admin_orders' %}" class="btn btn-secondary">Ver Todos os Pedidos</a>
  </div>
</div>

<!-- Combos em Destaque -->
<div class="admin-card">
  <h2 class="admin-card-title">üçî Combos Cadastrados</h2>
  {% if combos %}
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
    {% for combo in combos %}
    <div style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 1rem; text-align: center;">
      {% if combo.image %}
      <img src="{{ combo.image.url }}" alt="{{ combo.name }}" style="width: 100%; height: 120px; object-fit: cover; border-radius: 8px; margin-bottom: 0.5rem;">
      {% else %}
      <div style="width: 100%; height: 120px; background: #f3f4f6; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 0.5rem; font-size: 2rem;">
        üçî
      </div>
      {% endif %}
      <h3 style="font-size: 0.95rem; margin-bottom: 0.25rem;">{{ combo.name }}</h3>
      <p style="color: #667eea; font-weight: 600; margin-bottom: 0.5rem;">R$ {{ combo.price }}</p>
      <a href="/admin/marketplace/combo/{{ combo.id }}/change/" class="btn btn-secondary" target="_blank" style="padding: 0.5rem 1rem; font-size: 0.85rem; width: 100%;">
        Editar
      </a>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p style="color: #666; text-align: center; padding: 2rem;">Nenhum combo cadastrado.</p>
  {% endif %}
  
  <div style="margin-top: 1rem; text-align: center;">
    <a href="{% url 'admin_combos' %}" class="btn btn-secondary">Ver Todos os Combos</a>
  </div>
</div>
{% endblock %}
